<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="/liu_lab/feed.xml" rel="self" type="application/atom+xml" /><link href="/liu_lab/" rel="alternate" type="text/html" /><updated>2024-03-04T02:56:14+00:00</updated><id>/liu_lab/feed.xml</id><title type="html">Liu Lab @ UIC</title><subtitle>An engaging 1-3 sentence description of your lab.</subtitle><entry><title type="html">Biomechanics of gait</title><link href="/liu_lab/2024/02/29/Biomechanics_of_gait.html" rel="alternate" type="text/html" title="Biomechanics of gait" /><published>2024-02-29T00:00:00+00:00</published><updated>2024-03-04T02:55:29+00:00</updated><id>/liu_lab/2024/02/29/Biomechanics_of_gait</id><content type="html" xml:base="/liu_lab/2024/02/29/Biomechanics_of_gait.html"><![CDATA[<h1 id="biomechanics-of-gait-analysis">Biomechanics of gait analysis</h1>
<ol>
  <li>Watch the following videos:
https://www.youtube.com/watch?v=LAOS8I6dFy4&amp;t=396s</li>
</ol>]]></content><author><name>Chang Liu</name></author><category term="Gait analysis" /><category term="Biomechanics" /><summary type="html"><![CDATA[Biomechanics of gait analysis Watch the following videos: https://www.youtube.com/watch?v=LAOS8I6dFy4&amp;t=396s]]></summary></entry><entry><title type="html">Learning EEG</title><link href="/liu_lab/2024/02/28/Learning-EEG.html" rel="alternate" type="text/html" title="Learning EEG" /><published>2024-02-28T00:00:00+00:00</published><updated>2024-03-04T02:55:29+00:00</updated><id>/liu_lab/2024/02/28/Learning%20EEG</id><content type="html" xml:base="/liu_lab/2024/02/28/Learning-EEG.html"><![CDATA[<h1 id="eeg-tutorial">EEG Tutorial</h1>
<ol>
  <li>
    <p>Where do we start:
<a href="https://eeglab.org/tutorials/">EEGLAB Tutorial</a></p>
  </li>
  <li>
    <p>A clean/resting state human EEG dataset to test your rejection:
R:\Ferris-Lab\liu.chang1\DATA\SampleData\2019-12-19_humanExampleData\Raw</p>
  </li>
  <li>
    <p>Downey et al. 2023: iCanClean to remove motion artifacts with the dual-layer electrode design
<a href="https://www.mdpi.com/1424-8220/23/19/8214">Paper on iCanClean</a></p>
  </li>
</ol>

<h2 id="overall-flowchart">Overall flowchart</h2>
<p><img src="https://github.com/changliu-99/liu_lab/assets/17205418/aefb93bc-1c2a-47da-8a31-63cfdc2d203a" alt="image" /></p>

<h2 id="some-useful-code-blocks">Some useful code blocks</h2>
<p>High-pass filter at 1Hz</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">EEG</span> <span class="o">=</span> <span class="n">pop_eegfiltnew</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span> <span class="s1">'locutoff'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'chantype'</span><span class="p">,{</span><span class="s1">'EEG'</span> <span class="s1">'EMG'</span> <span class="s1">'Noise'</span><span class="p">});</span>
</code></pre></div></div>

<p>Keep only a subset of chans</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">EEG_chans</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="nb">strcmpi</span><span class="p">(</span><span class="s1">'EEG'</span><span class="p">,{</span><span class="n">EEG</span><span class="o">.</span><span class="n">chanlocs</span><span class="o">.</span><span class="nb">type</span><span class="p">}));</span> <span class="c1">%define channels</span>
<span class="n">EMG_chans</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="nb">strcmpi</span><span class="p">(</span><span class="s1">'EMG'</span><span class="p">,{</span><span class="n">EEG</span><span class="o">.</span><span class="n">chanlocs</span><span class="o">.</span><span class="nb">type</span><span class="p">}));</span>
<span class="n">Noise_chans</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="nb">strcmpi</span><span class="p">(</span><span class="s1">'Noise'</span><span class="p">,{</span><span class="n">EEG</span><span class="o">.</span><span class="n">chanlocs</span><span class="o">.</span><span class="nb">type</span><span class="p">}));</span>

<span class="n">EEG</span> <span class="o">=</span> <span class="n">pop_select</span><span class="p">(</span> <span class="n">EEG</span><span class="p">,</span> <span class="s1">'channel'</span><span class="p">,</span> <span class="nb">sort</span><span class="p">([</span><span class="n">EEG_chans</span><span class="p">,</span> <span class="n">EMG_chans</span><span class="p">,</span><span class="n">Noise_chans</span><span class="p">]));</span> <span class="c1">%select subset of channels</span>
<span class="n">EEG</span> <span class="o">=</span> <span class="n">pop_select</span><span class="p">(</span> <span class="n">EEG</span><span class="p">,</span> <span class="s1">'channel'</span><span class="p">,</span> <span class="nb">sort</span><span class="p">([</span><span class="n">EEG_chans</span><span class="p">]));</span> <span class="c1">%select just EEG channels</span>

<span class="c1">%update channel labels again just in case</span>
<span class="n">EEG_chans</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="nb">strcmpi</span><span class="p">(</span><span class="s1">'EEG'</span><span class="p">,{</span><span class="n">EEG</span><span class="o">.</span><span class="n">chanlocs</span><span class="o">.</span><span class="nb">type</span><span class="p">}));</span> 
<span class="n">EMG_chans</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="nb">strcmpi</span><span class="p">(</span><span class="s1">'EMG'</span><span class="p">,{</span><span class="n">EEG</span><span class="o">.</span><span class="n">chanlocs</span><span class="o">.</span><span class="nb">type</span><span class="p">}));</span>
<span class="n">Noise_chans</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="nb">strcmpi</span><span class="p">(</span><span class="s1">'Noise'</span><span class="p">,{</span><span class="n">EEG</span><span class="o">.</span><span class="n">chanlocs</span><span class="o">.</span><span class="nb">type</span><span class="p">}));</span>
</code></pre></div></div>

<p>Re-reference and do cleanline</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">EEG</span> <span class="o">=</span> <span class="n">rerefC2CN2NExt2Ext_func</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span><span class="n">fullRankAvRefBool</span><span class="p">);</span>
<span class="n">EEG</span> <span class="o">=</span> <span class="n">pop_cleanline</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span> <span class="s1">'bandwidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">'chanlist'</span><span class="p">,[</span><span class="n">EEG_chans</span> <span class="n">EMG_chans</span> <span class="n">Noise_chans</span><span class="p">],</span><span class="s1">'computepower'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="k">...</span>
    <span class="s1">'linefreqs'</span><span class="p">,[</span><span class="mi">60</span> <span class="mi">120</span><span class="p">],</span><span class="s1">'newversion'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'normSpectrum'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'p'</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="s1">'pad'</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">'plotfigures'</span><span class="p">,</span><span class="k">...</span>
<span class="mi">0</span><span class="p">,</span><span class="s1">'scanforlines'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'sigtype'</span><span class="p">,</span><span class="s1">'Channels'</span><span class="p">,</span><span class="s1">'taperbandwidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">'tau'</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="s1">'verb'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'winsize'</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s1">'winstep'</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="useful-preprocessing-code-block">Useful preprocessing code block</h2>
<p>Please send me an email to request access to the example code <a href="https://github.com/changliu-99/Reference-code/tree/3a58c382a47f5cc7278c404ea96afbf3dfee976f/EEG/Preprocessing">Example code</a></p>

<p>Step 1: Remove bad channels based on standard deviation and kurtosis:</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">EEG</span> <span class="o">=</span> <span class="n">autoRejCh_func_CL</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span><span class="n">threshold</span><span class="p">);</span>
</code></pre></div></div>

<p>Step 2: Perform average re-reference of EEG, EMG, and Noice channels</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullRankAvRefBool</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">EEG</span> <span class="o">=</span> <span class="n">rerefC2CN2NExt2Ext_func</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span><span class="n">fullRankAvRefBool</span><span class="p">);</span>
</code></pre></div></div>

<p>Optional Step: Remove motion artifact with iCanClean</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">EEG</span><span class="p">]</span> <span class="o">=</span> <span class="n">iCanClean</span><span class="p">(</span><span class="n">EEG</span><span class="p">,[</span><span class="n">EEG_chans</span><span class="p">],</span> <span class="p">[</span><span class="n">Noise_chans</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="p">);</span>
</code></pre></div></div>

<p>Optional Step: Remove muscle artifact with iCanClean</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">EEG</span><span class="p">]</span> <span class="o">=</span> <span class="n">iCanClean</span><span class="p">(</span><span class="n">EEG</span><span class="p">,[</span><span class="n">EEG_chans</span><span class="p">],</span> <span class="p">[</span><span class="n">EMG_chans</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="p">);</span>
</code></pre></div></div>

<p>Optional Step: Use EEGLABâ€™s channel rejection/time rejection method with parameters</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">EEG_clean</span><span class="p">,</span><span class="n">EEG_clean_timerej</span><span class="p">,</span><span class="n">p_frames_rej</span><span class="p">,</span><span class="n">p_chan_rej</span><span class="p">]</span> <span class="o">=</span> <span class="n">channelrejection_wrap</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span><span class="n">config</span><span class="p">);</span>
</code></pre></div></div>]]></content><author><name>Chang Liu</name></author><category term="EEG" /><summary type="html"><![CDATA[EEG Tutorial Where do we start: EEGLAB Tutorial A clean/resting state human EEG dataset to test your rejection: R:\Ferris-Lab\liu.chang1\DATA\SampleData\2019-12-19_humanExampleData\Raw Downey et al. 2023: iCanClean to remove motion artifacts with the dual-layer electrode design Paper on iCanClean Overall flowchart]]></summary></entry><entry><title type="html">Statistical Analysis Tutorial/Useful links</title><link href="/liu_lab/2024/02/08/Stats-tutorial.html" rel="alternate" type="text/html" title="Statistical Analysis Tutorial/Useful links" /><published>2024-02-08T00:00:00+00:00</published><updated>2024-03-04T02:55:29+00:00</updated><id>/liu_lab/2024/02/08/Stats-tutorial</id><content type="html" xml:base="/liu_lab/2024/02/08/Stats-tutorial.html"><![CDATA[<p>Useful links:
https://rpsychologist.com/cohend/</p>]]></content><author><name>Chang Liu</name></author><category term="statistics" /><summary type="html"><![CDATA[Useful links: https://rpsychologist.com/cohend/]]></summary></entry></feed>